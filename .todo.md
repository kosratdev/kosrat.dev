# Courses Feature Todo List

This file tracks the implementation of the "Courses" feature as specified in `fr- [x] **Refactor Content Utils**: Split the large `src/utils/content-utils.ts` (372 lines) into focused modules
  - [x] Create `src/utils/content/` directory structure
  - [x] Split into modules: `post-utils.ts`, `course-utils.ts`, `archive-utils.ts`, `types.ts`
  - [x] Create barrel export in `src/utils/content/index.ts`
  - [x] Update all imports across the codebase
  - [x] Remove legacy `content-utils.ts` file and use direct module imports.md`.

## 1. Content Structure and Management

- [x] Create a new content collection for courses in `src/content/courses`.
- [x] Define the schema for courses, sections, and lessons, including fields for title, cover image, description, level (Beginner, Intermediate, Advanced), and category.
- [x] Set up content structure for courses with proper hierarchy (courses → sections → lessons).
- [x] Create sample course content to test the implementation.

## 2. Feature Entry Points

- [x] Add a "Courses" link to the main navigation menu (`src/components/Navbar.astro`) between "Home" and "Archive".
- [x] Create a new "Courses" card in the sidebar (`src/components/widget/Courses.astro`) that lists available courses.
- [x] Implement functionality to "pin" a course to the top of the main post list on the home page for increased visibility.

## 3. Courses List Page (`/courses/`)

- [x] Create a new page at `/courses/` to display all available courses.
- [x] Adapt the existing `src/components/PostCard.astro` to create a `CourseCard.astro` component for the courses list.
- [x] The course card should display:
  - [x] Title
  - [x] Cover image
  - [x] Description
  - [x] Level (Beginner, Intermediate, Advanced)
  - [x] Category
  - [x] Total number of lessons
  - [x] "Start Course" or "Continue" button (based on progress from localStorage).

## 4. Course Detail Page (`/courses/[course-slug]/`)

- [x] Create a dynamic route for course detail pages.
- [x] Display course information at the top:
  - [x] Course name and metadata
  - [x] "Reset Progress" button
- [x] Implement course sections display:
  - [x] Show sections as collapsible accordion elements
  - [x] Clicking a section title toggles its collapsed/expanded state
  - [x] Add check marks to indicate completed sections
  - [x] Add check marks to indicate completed lessons within sections
  - [x] Clicking a lesson title navigates to the lesson content

## 5. Lesson Content Page (`/courses/[course-slug]/[section-slug]/[lesson-slug]/`)

- [x] Create dynamic route for individual lesson pages.
- [x] Display course and section info at the top of the page.
- [x] Render lesson content using the existing `PostPage.astro` component structure.
- [x] Implement lesson navigation:
  - [x] Add "Next" and "Previous" buttons at the bottom of each lesson
  - [x] First lesson of first section: no "Previous" button
  - [x] Last lesson of last section: "Finish" button instead of "Next"
  - [x] Middle lessons: both "Previous" and "Next" buttons
- [x] Implement progress tracking:
  - [x] Structure for localStorage-based lesson completion tracking (awaiting utility functions from section 6)
  - [x] JavaScript event handlers for "Next" and "Finish" buttons
  - [x] Course completion flow and redirect logic
  - [x] Progress persistence structure across browser sessions

## 6. Progress Management

- [x] Create utility functions for localStorage-based progress tracking:
  - [x] `getCourseProgress(courseSlug)` - get completion status for all lessons
  - [x] `markLessonCompleted(courseSlug, lessonSlug)` - mark a lesson as completed
  - [x] `resetCourseProgress(courseSlug)` - reset all progress for a course
  - [x] `getLastViewedLesson(courseSlug)` - get the last lesson viewed in a course
- [x] Implement progress indicators:
  - [x] Course card progress (completed lessons / total lessons)
  - [x] Section completion indicators
  - [x] Individual lesson completion checkmark
  - [x] Course card progress (completed lessons / total lessons)
  - [x] Section completion indicators
  - [x] Individual lesson completion checkmark

## 7. Existing Feature Integration

- [x] Update the Archive page (`src/pages/archive.astro`):
  - [x] Include courses and lessons in the timeline alongside posts
  - [x] Add content type labels ("Post", "Course", or "Lesson") to differentiate items
  - [x] Maintain chronological ordering based on publication date
- [x] Update global search functionality (`src/components/Search.svelte`):
  - [x] Include course content in search results
  - [x] Include lesson content in search results
  - [x] Add appropriate search result formatting for course content

## 8. UI/UX Enhancements

- [x] Ensure responsive design for all course-related pages
- [x] ~~Implement proper loading states for course content~~ (Not needed - static site with pre-generated content)
- [x] Add proper error handling for missing courses/lessons
- [x] Ensure accessibility compliance for accordion sections and navigation
- [x] Test mobile experience for collapsible sections and lesson navigation

## 9. SEO and Performance

- [x] Implement proper meta tags for course and lesson pages
- [x] Set up structured data for educational content
- [x] Optimize course content for search engines
- [x] Ensure proper URL structure for courses (`/courses/course-slug/section-slug/lesson-slug/`)

## 10. Code Quality & Refactoring Improvements (Post-Implementation)

### High Priority Refactoring

- [x] **Extract Slug Utilities**: Create `src/utils/slug-utils.ts` to centralize slug cleaning logic
  - [x] Move `cleanSlug()` function from multiple files to shared utility
  - [x] Create `extractSlugParts()` function for consistent slug parsing
  - [x] Update all files using slug manipulation to use centralized functions

- [x] **Refactor Content Utils**: Split oversized `src/utils/content-utils.ts` (380+ lines)
  - [x] Create `src/utils/content/post-utils.ts`
  - [x] Create `src/utils/content/course-utils.ts`
  - [x] Create `src/utils/content/archive-utils.ts`
  - [x] Create `src/utils/content/types.ts` for shared types
  - [x] Move related functions to appropriate modules

- [ ] **Improve Component Abstraction**: Remove code duplication in components
  - [ ] Replace `PostOrCourseCard.astro` wrapper with unified `ContentCard.astro`
  - [ ] Create reusable `ContentMeta.astro` for metadata display
  - [ ] Unify navigation logic between posts and lessons
  - [ ] Extract common card layouts and styling

- [ ] **Enhance Type Safety**: Implement proper type guards and assertions
  - [ ] Create `src/utils/type-guards.ts` with reusable type guards
  - [ ] Replace scattered type checks with centralized functions
  - [ ] Add proper TypeScript assertions for better type safety
  - [ ] Implement runtime type validation for content entries

### Medium Priority Improvements

- [ ] **SEO Utils Refactoring**: Improve SEO utility organization
  - [ ] Split `seo-utils.ts` into focused modules:
    - [ ] `src/utils/seo/metadata-generators.ts`
    - [ ] `src/utils/seo/structured-data.ts`
    - [ ] `src/utils/seo/keywords.ts`
  - [ ] Implement MetadataGenerator class for centralized logic
  - [ ] Create StructuredDataFactory for reusable patterns
  - [ ] Remove repetitive type guards and consolidate logic

- [ ] **Configuration Management**: Organize configuration better
  - [ ] Create `src/config/course-config.ts` for course-specific settings
  - [ ] Move pinned course config from site config to dedicated config
  - [ ] Create typed configuration interfaces
  - [ ] Implement configuration validation

- [ ] **Content Fetching Optimization**: Improve data fetching efficiency
  - [ ] Implement content caching mechanism (`src/utils/content/cache.ts`)
  - [ ] Reduce duplicate `getAllCourseLessons()` calls
  - [ ] Optimize sorting operations
  - [ ] Add content preloading strategies

- [ ] **Error Handling Enhancement**: Add comprehensive error boundaries
  - [ ] Implement error handling in dynamic route generation
  - [ ] Add fallbacks for content fetching failures
  - [ ] Improve localStorage error handling in progress utils
  - [ ] Add proper error logging and user feedback

### Lower Priority Polish

- [ ] **Progress Utils Improvements**: Enhance progress tracking
  - [ ] Add data migration strategy for progress format changes
  - [ ] Implement progress data validation and recovery
  - [ ] Add progress analytics and insights
  - [ ] Create progress export/import functionality

- [ ] **Performance Optimizations**: Optimize loading and rendering
  - [ ] Implement lazy loading for course images
  - [ ] Add progressive loading for course content
  - [ ] Optimize bundle size for course-related components
  - [ ] Implement client-side caching for frequently accessed data

- [ ] **Accessibility Enhancements**: Improve accessibility compliance
  - [ ] Add comprehensive ARIA labels for course navigation
  - [ ] Implement keyboard navigation for course content
  - [ ] Enhance screen reader support for progress indicators
  - [ ] Add focus management for collapsible sections

- [ ] **Development Experience**: Improve developer tools and testing
  - [ ] Add unit tests for utility functions
  - [ ] Create integration tests for course flow
  - [ ] Add TypeScript strict mode compliance
  - [ ] Implement component documentation and Storybook

### Code Quality Metrics Goals

- [ ] **Reduce code duplication**: Target <5% duplicate code
- [ ] **Improve type safety**: 100% TypeScript strict mode compliance
- [ ] **Enhance maintainability**: Split large files (>200 lines)
- [ ] **Optimize performance**: Reduce bundle size by 15%
- [ ] **Increase test coverage**: Achieve >80% test coverage for utils
